import"./index-BYdHSxkt.js";/* empty css                  *//* empty css               *//* empty css                 */import{g as E,d as U}from"./index-cjkz5sae.js";/* empty css                       *//* empty css                 *//* empty css                   */import{_ as M,E as k,$ as S,z as R,T as A}from"./element-B-FiLDCl.js";import{v as O,aE as w,W as y,n as B,af as h,x as F,y as I,O as n,F as s,u as g,K as x,L as P,A as D}from"./vue-Cwi6Gi-M.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vxe-5K_zVHhu.js";const V={class:"app-container"},q=O({name:"VxeTable",__name:"index",setup(z){const p=w("xGridDom"),b=y({loading:!0,autoResize:!0,pagerConfig:{align:"right"},formConfig:{items:[{field:"username",itemRender:{name:"VxeInput",props:{placeholder:"Username",clearable:!0}}},{field:"phone",itemRender:{name:"VxeInput",props:{placeholder:"Phone",clearable:!0}}},{itemRender:{name:"VxeButtonGroup",options:[{type:"submit",content:"Search",status:"primary",icon:"vxe-icon-search"},{type:"reset",content:"Reset",icon:"vxe-icon-refresh"}]}}]},toolbarConfig:{refresh:!0,custom:!0,slots:{buttons:"toolbar-btns"}},customConfig:{checkMethod:({column:e})=>!["username"].includes(e.field)},columns:[{type:"checkbox",width:"50px"},{field:"username",title:"Username"},{field:"roles",title:"Role",slots:{default:"role-column"}},{field:"phone",title:"Phone"},{field:"email",title:"Email"},{field:"status",title:"Status",slots:{default:"status-column"}},{field:"createTime",title:"Create Time"},{title:"Actions",width:"150px",fixed:"right",showOverflow:!1,slots:{default:"row-operate"}}],proxyConfig:{seq:!0,form:!0,autoLoad:!0,props:{total:"total"},ajax:{query:({page:e,form:t})=>(b.loading=!0,r.clearTable(),new Promise(o=>{let a=0,c=[];const u=l=>{l!=null&&l.data&&(a=l.data.total,c=l.data.list),b.loading=!1,o({total:a,result:c})},f={username:t.username||"",phone:t.phone||"",size:e.pageSize,currentPage:e.currentPage};E(f).then(u).catch(u)}))}}}),_=w("xModalDom"),C=y({title:"",showClose:!0,escClosable:!0,maskClosable:!0,beforeHideMethod:()=>{var e;return(e=v.value)==null||e.clearValidate(),Promise.resolve()}}),v=w("xFormDom"),m=y({span:24,titleWidth:"100px",loading:!1,titleColon:!1,data:{username:"",password:""},items:[{field:"username",title:"Username",itemRender:{name:"$input",props:{placeholder:"Please enter"}}},{field:"password",title:"Password",itemRender:{name:"$input",props:{placeholder:"Please enter"}}},{align:"right",itemRender:{name:"$buttons",children:[{props:{content:"Cancel"},events:{click:()=>{var e;return(e=_.value)==null?void 0:e.close()}}},{props:{type:"submit",content:"Confirm",status:"primary"},events:{click:()=>r.onSubmitForm()}}]}}],rules:{username:[{required:!0,validator:({itemValue:e})=>{switch(!0){case!e:return new Error("Please enter");case!e.trim():return new Error("Whitespace invalid")}}}],password:[{required:!0,validator:({itemValue:e})=>{switch(!0){case!e:return new Error("Please enter");case!e.trim():return new Error("Whitespace invalid")}}}]}}),r=y({isUpdate:!0,commitQuery:()=>{var e;return(e=p.value)==null?void 0:e.commitProxy("query")},clearTable:()=>{var e;return(e=p.value)==null?void 0:e.reloadData([])},onShowModal:e=>{var o,a,c,u;e?(r.isUpdate=!0,C.title="Edit User",m.data.username=e.username):(r.isUpdate=!1,C.title="Add User");const t=(c=(a=(o=m.items)==null?void 0:o[0])==null?void 0:a.itemRender)==null?void 0:c.props;t&&(t.disabled=r.isUpdate),(u=_.value)==null||u.open(),B(()=>{var f,l;!r.isUpdate&&((f=v.value)==null||f.reset()),(l=v.value)==null||l.clearValidate()})},onSubmitForm:()=>{var e;m.loading||(e=v.value)==null||e.validate(t=>{if(t)return;m.loading=!0;const o=()=>{var a;m.loading=!1,(a=_.value)==null||a.close(),k.success("Operation successful"),!r.isUpdate&&r.afterInsert(),r.commitQuery()};r.isUpdate?setTimeout(()=>o(),1e3):setTimeout(()=>o(),1e3)})},afterInsert:()=>{var t,o;const e=(o=(t=p.value)==null?void 0:t.getProxyInfo())==null?void 0:o.pager;e&&e.currentPage*e.pageSize===e.total&&++e.currentPage},onDelete:e=>{const t=`Confirm <strong style="color: var(--el-color-danger);"> delete </strong> user <strong style="color: var(--el-color-primary);"> ${e.username} </strong> ?`,o={type:"warning",showClose:!0,closeOnClickModal:!0,closeOnPressEscape:!0,cancelButtonText:"Cancel",confirmButtonText:"Confirm",dangerouslyUseHTMLString:!0};M.confirm(t,"Warning",o).then(()=>{U(e.id).then(()=>{k.success("Delete successful"),r.afterDelete(),r.commitQuery()})})},afterDelete:()=>{var o,a;const e=p.value.getData(),t=(a=(o=p.value)==null?void 0:o.getProxyInfo())==null?void 0:a.pager;t&&t.currentPage>1&&e.length===1&&--t.currentPage},moreFn:()=>{}});return(e,t)=>{const o=S,a=h("vxe-button"),c=A,u=R,f=h("vxe-grid"),l=h("vxe-form"),T=h("vxe-modal");return I(),F("div",V,[n(o,{title:"Data Source",type:"success",description:"Online Mock data provided by Apifox, data is not real, only for basic CRUD demonstration","show-icon":""}),n(o,{title:"Note",type:"warning",description:"Current example is compatible with Vxe Table version up to 4.6.25","show-icon":""}),n(f,D({ref_key:"xGridDom",ref:p},g(b)),{"toolbar-btns":s(()=>[n(a,{status:"primary",icon:"vxe-icon-add",onClick:t[0]||(t[0]=i=>g(r).onShowModal())},{default:s(()=>t[1]||(t[1]=[x(" Add User ")])),_:1,__:[1]}),n(a,{status:"danger",icon:"vxe-icon-delete"},{default:s(()=>t[2]||(t[2]=[x(" Batch Delete ")])),_:1,__:[2]})]),"role-column":s(({row:i,column:d})=>[n(c,{type:i[d.field]==="admin"?"primary":"warning",effect:"plain"},{default:s(()=>[x(P(i[d.field]),1)]),_:2},1032,["type"])]),"status-column":s(({row:i,column:d})=>[n(c,{type:i[d.field]?"success":"danger",effect:"plain"},{default:s(()=>[x(P(i[d.field]?"Active":"Inactive"),1)]),_:2},1032,["type"])]),"row-operate":s(({row:i})=>[n(u,{link:"",type:"primary",onClick:d=>g(r).onShowModal(i)},{default:s(()=>t[3]||(t[3]=[x(" Edit ")])),_:2,__:[3]},1032,["onClick"]),n(u,{link:"",type:"danger",onClick:d=>g(r).onDelete(i)},{default:s(()=>t[4]||(t[4]=[x(" Delete ")])),_:2,__:[4]},1032,["onClick"])]),_:1},16),n(T,D({ref_key:"xModalDom",ref:_},g(C)),{default:s(()=>[n(l,D({ref_key:"xFormDom",ref:v},g(m)),null,16)]),_:1},16)])}}}),ee=$(q,[["__scopeId","data-v-cffa7286"]]);export{ee as default};
