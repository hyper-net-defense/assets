import{p as b}from"./index-BYdHSxkt.js";/* empty css                   */import{u as j}from"./usePagination-NdQ2qoRW.js";/* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 */import"./el-tooltip-l0sNRNKZ.js";/* empty css                *//* empty css                  */import{H as G,I as H,J,z as K,M as Q,y as X,N as Y,O as Z,n as ee,W as ae,Q as le,R as te,S as ie,U as oe,V as ne,E as p,_ as re}from"./element-B-FiLDCl.js";/* empty css                       */import{v as se,r as d,aE as D,W as ue,j as me,x as de,y as P,O as a,G as fe,F as l,u as o,K as v,E as pe,B as g}from"./vue-Cwi6Gi-M.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vxe-5K_zVHhu.js";function _e(u){return b({url:"/admin/notify_email/list",method:"post",data:u})}function ve(u){return b({url:"/admin/notify_email/add",method:"post",data:u})}function ge(u){return b({url:"/admin/notify_email/update",method:"post",data:u})}function Ee(u){return b({url:"/admin/notify_email/delete",method:"post",data:{id:u}})}const ye={class:"app-container"},he={class:"toolbar-wrapper"},Ce={class:"table-wrapper"},be={class:"pager-wrapper"},Ve=se({__name:"index",setup(u){const E=d(!1),c=d(!1),y=d(!1),h=d({email:""}),S=D("searchFormRef"),V=d([]),_=d(!1),k=d(""),n=d({id:"",name:"",email:""}),T=ue({name:[{required:!0,trigger:"blur",message:"The name is required."}],email:[{required:!0,trigger:"blur",message:"The pattern is required."}]}),N=D("notificationEmailFormRef"),{paginationData:r,handleCurrentChange:B,handleSizeChange:q}=j();function f(){if(E.value)return;E.value=!0;const t={email:h.value.email,curPage:r.currentPage,pageSize:r.pageSize};_e(t).then(e=>{e.success&&e.data&&e.pagination?(V.value=e.data.notification_email_list,r.total=e.pagination.total):(V.value=[],r.total=0)}).finally(()=>{E.value=!1})}function z(t){t?(k.value="Edit Notification Email",n.value={...t}):(k.value="Add Notification Email",n.value={id:"",name:"",email:""}),_.value=!0}function U(){var t;c.value||(c.value=!0,(t=N.value)==null||t.validate(e=>{if(!e){p.error("The form validation failed."),c.value=!1;return}n.value.id?ge(n.value).then(s=>{s.success?(p.success("Succeed to update."),_.value=!1,f()):p.error(s.message||"Failed to update.")}).finally(()=>{c.value=!1}):ve(n.value).then(s=>{s.success?(p.success("Succeed to add."),_.value=!1,f()):p.error(s.message||"Failed to add.")}).finally(()=>{c.value=!1})}))}function $(t){re.confirm(`Are you sure to delete this email "${t.name}"?`,"Confirm",{type:"warning"}).then(()=>{t.id&&(y.value||(y.value=!0,Ee(t.id).then(e=>{e.success?(p.success("Succeed to delete."),f()):p.error(e.message||"Failed to delete.")}).finally(()=>{y.value=!1})))}).catch(()=>{y.value=!1})}function A(){var t;(t=S.value)==null||t.resetFields(),f()}return me([()=>r.currentPage,()=>r.pageSize],f,{immediate:!0}),(t,e)=>{const s=J,C=H,m=K,R=G,x=Y,w=ee,F=ie,I=te,L=oe,M=ne,O=Z;return P(),de("div",ye,[a(x,{shadow:"never",class:"search-wrapper"},{default:l(()=>[a(R,{inline:!0,ref_key:"searchFormRef",ref:S,model:h.value},{default:l(()=>[a(C,{label:"Email",prop:"email"},{default:l(()=>[a(s,{modelValue:h.value.email,"onUpdate:modelValue":e[0]||(e[0]=i=>h.value.email=i),placeholder:"Search email",clearable:""},null,8,["modelValue"])]),_:1}),a(C,null,{default:l(()=>[a(m,{type:"primary",icon:o(Q),onClick:f},{default:l(()=>e[6]||(e[6]=[v(" Search ")])),_:1,__:[6]},8,["icon"]),a(m,{icon:o(X),onClick:A},{default:l(()=>e[7]||(e[7]=[v(" Reset ")])),_:1,__:[7]},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1}),fe((P(),pe(x,{shadow:"never"},{default:l(()=>[g("div",he,[e[8]||(e[8]=g("div",null,null,-1)),g("div",null,[a(w,{content:"Add new"},{default:l(()=>[a(m,{type:"primary",icon:o(ae),circle:"",onClick:e[1]||(e[1]=i=>z())},null,8,["icon"])]),_:1}),a(w,{content:"Refresh current page"},{default:l(()=>[a(m,{type:"primary",icon:o(le),circle:"",onClick:f},null,8,["icon"])]),_:1})])]),g("div",Ce,[a(I,{data:V.value,stripe:""},{default:l(()=>[a(F,{prop:"name",label:"Name"}),a(F,{prop:"email",label:"Email"}),a(F,{label:"Action",width:"150"},{default:l(({row:i})=>[a(m,{plain:"",type:"primary",size:"small",onClick:W=>z(i)},{default:l(()=>e[9]||(e[9]=[v(" Edit ")])),_:2,__:[9]},1032,["onClick"]),a(m,{type:"danger",size:"small",onClick:W=>$(i)},{default:l(()=>e[10]||(e[10]=[v(" Delete ")])),_:2,__:[10]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),g("div",be,[a(L,{background:"",layout:o(r).layout,total:o(r).total,"page-size":o(r).pageSize,"current-page":o(r).currentPage,onCurrentChange:o(B),onSizeChange:o(q)},null,8,["layout","total","page-size","current-page","onCurrentChange","onSizeChange"])])]),_:1})),[[O,E.value]]),a(M,{title:k.value,modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=i=>_.value=i),width:"500px"},{footer:l(()=>[a(m,{onClick:e[4]||(e[4]=i=>_.value=!1)},{default:l(()=>e[11]||(e[11]=[v(" Cancel ")])),_:1,__:[11]}),a(m,{type:"primary",loading:c.value,onClick:U},{default:l(()=>e[12]||(e[12]=[v(" Save ")])),_:1,__:[12]},8,["loading"])]),default:l(()=>[a(R,{model:n.value,rules:o(T),ref_key:"notificationEmailFormRef",ref:N,"label-width":"120px","label-position":"left"},{default:l(()=>[a(C,{label:"Name",prop:"name"},{default:l(()=>[a(s,{modelValue:n.value.name,"onUpdate:modelValue":e[2]||(e[2]=i=>n.value.name=i)},null,8,["modelValue"])]),_:1}),a(C,{label:"Email",prop:"email"},{default:l(()=>[a(s,{modelValue:n.value.email,"onUpdate:modelValue":e[3]||(e[3]=i=>n.value.email=i)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}}),Ie=ce(Ve,[["__scopeId","data-v-934946e7"]]);export{Ie as default};
