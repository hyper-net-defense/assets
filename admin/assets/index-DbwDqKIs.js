import{p as h}from"./index-Dy79iS0B.js";/* empty css                   */import{u as j}from"./usePagination-NdQ2qoRW.js";/* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 */import"./el-tooltip-l0sNRNKZ.js";/* empty css                *//* empty css                  */import{H as G,I as H,J,z as K,M as Q,y as X,N as Y,O as Z,n as ee,W as ae,Q as le,R as te,S as oe,U as ne,V as se,E as c,_ as re}from"./element-B-FiLDCl.js";/* empty css                       */import{v as ie,r as d,aE as x,W as ue,j as pe,x as de,y as D,O as a,G as me,F as l,u as r,K as g,E as ce,B as b}from"./vue-Cwi6Gi-M.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vxe-5K_zVHhu.js";function _e(u){return h({url:"/admin/vm_app/list",method:"post",data:u})}function ve(u){return h({url:"/admin/vm_app/add",method:"post",data:u})}function ge(u){return h({url:"/admin/vm_app/update",method:"post",data:u})}function Ve(u){return h({url:"/admin/vm_app/delete",method:"post",data:{id:u}})}const ke={class:"app-container"},be={class:"toolbar-wrapper"},ye={class:"table-wrapper"},Ce={class:"pager-wrapper"},he=ie({__name:"index",setup(u){const y=d(!1),f=d(!1),V=d(!1),C=d({name:""}),w=x("searchFormRef"),A=d([]),_=d(!1),E=d(""),n=d({id:"",name:"",link:"",process_win:"",process_mac:""}),T=ue({name:[{required:!0,trigger:"blur",message:"The name is required."}],link:[{required:!0,trigger:"blur",message:"The link is required."}]}),F=x("vmAppFormRef"),{paginationData:i,handleCurrentChange:B,handleSizeChange:M}=j();function m(){if(y.value)return;y.value=!0;const o={name:C.value.name,curPage:i.currentPage,pageSize:i.pageSize};_e(o).then(e=>{e.success&&e.data&&e.pagination?(A.value=e.data.vm_app_list,i.total=e.pagination.total):(A.value=[],i.total=0)}).finally(()=>{y.value=!1})}function S(o){o?(E.value="Edit VM App",n.value={...o}):(E.value="Add VM App",n.value={id:"",name:"",link:"",process_win:"",process_mac:""}),_.value=!0}function N(){var o;f.value||(f.value=!0,(o=F.value)==null||o.validate(e=>{if(!e){c.error("The form validation failed."),f.value=!1;return}n.value.id?ge(n.value).then(s=>{s.success?(c.success("Succeed to update."),_.value=!1,m()):c.error(s.message||"Failed to update.")}).finally(()=>{f.value=!1}):ve(n.value).then(s=>{s.success?(c.success("Succeed to add."),_.value=!1,m()):c.error(s.message||"Failed to add.")}).finally(()=>{f.value=!1})}))}function U(o){re.confirm(`Are you sure to delete this app "${o.name}"?`,"Confirm",{type:"warning"}).then(()=>{o.id&&(V.value||(V.value=!0,Ve(o.id).then(e=>{e.success?(c.success("Succeed to delete."),m()):c.error(e.message||"Failed to delete.")}).finally(()=>{V.value=!1})))}).catch(()=>{V.value=!1})}function L(){var o;(o=w.value)==null||o.resetFields(),m()}return pe([i.currentPage,i.pageSize],m,{immediate:!0}),(o,e)=>{const s=J,v=H,p=K,P=G,z=Y,R=ee,k=oe,q=te,$=ne,I=se,W=Z;return D(),de("div",ke,[a(z,{shadow:"never",class:"search-wrapper"},{default:l(()=>[a(P,{inline:!0,ref_key:"searchFormRef",ref:w,model:C.value},{default:l(()=>[a(v,{label:"Name",prop:"name"},{default:l(()=>[a(s,{modelValue:C.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>C.value.name=t),placeholder:"Search name",clearable:""},null,8,["modelValue"])]),_:1}),a(v,null,{default:l(()=>[a(p,{type:"primary",icon:r(Q),onClick:m},{default:l(()=>e[8]||(e[8]=[g(" Search ")])),_:1,__:[8]},8,["icon"]),a(p,{icon:r(X),onClick:L},{default:l(()=>e[9]||(e[9]=[g(" Reset ")])),_:1,__:[9]},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1}),me((D(),ce(z,{shadow:"never"},{default:l(()=>[b("div",be,[e[10]||(e[10]=b("div",null,null,-1)),b("div",null,[a(R,{content:"Add new"},{default:l(()=>[a(p,{type:"primary",icon:r(ae),circle:"",onClick:e[1]||(e[1]=t=>S())},null,8,["icon"])]),_:1}),a(R,{content:"Refresh current page"},{default:l(()=>[a(p,{type:"primary",icon:r(le),circle:"",onClick:m},null,8,["icon"])]),_:1})])]),b("div",ye,[a(q,{data:A.value,stripe:""},{default:l(()=>[a(k,{prop:"name",label:"Name"}),a(k,{prop:"link",label:"Link"}),a(k,{prop:"process_win",label:"Win Process"}),a(k,{prop:"process_mac",label:"Mac Process"}),a(k,{label:"Action",width:"150"},{default:l(({row:t})=>[a(p,{plain:"",type:"primary",size:"small",onClick:O=>S(t)},{default:l(()=>e[11]||(e[11]=[g(" Edit ")])),_:2,__:[11]},1032,["onClick"]),a(p,{type:"danger",size:"small",onClick:O=>U(t)},{default:l(()=>e[12]||(e[12]=[g(" Delete ")])),_:2,__:[12]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),b("div",Ce,[a($,{background:"",layout:r(i).layout,total:r(i).total,"page-size":r(i).pageSize,"current-page":r(i).currentPage,onCurrentChange:r(B),onSizeChange:r(M)},null,8,["layout","total","page-size","current-page","onCurrentChange","onSizeChange"])])]),_:1})),[[W,y.value||V.value]]),a(I,{title:E.value,modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=t=>_.value=t),width:"500px"},{footer:l(()=>[a(p,{onClick:e[6]||(e[6]=t=>_.value=!1)},{default:l(()=>e[13]||(e[13]=[g(" Cancel ")])),_:1,__:[13]}),a(p,{type:"primary",loading:f.value,onClick:N},{default:l(()=>e[14]||(e[14]=[g(" Save ")])),_:1,__:[14]},8,["loading"])]),default:l(()=>[a(P,{model:n.value,rules:r(T),ref_key:"vmAppFormRef",ref:F,"label-width":"120px","label-position":"left"},{default:l(()=>[a(v,{label:"Name",prop:"name"},{default:l(()=>[a(s,{modelValue:n.value.name,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.name=t)},null,8,["modelValue"])]),_:1}),a(v,{label:"Link",prop:"link"},{default:l(()=>[a(s,{modelValue:n.value.link,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.link=t)},null,8,["modelValue"])]),_:1}),a(v,{label:"Win Process",prop:"process_win"},{default:l(()=>[a(s,{modelValue:n.value.process_win,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.process_win=t)},null,8,["modelValue"])]),_:1}),a(v,{label:"Mac Process",prop:"process_mac"},{default:l(()=>[a(s,{modelValue:n.value.process_mac,"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.process_mac=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}}),qe=fe(he,[["__scopeId","data-v-5076bd3a"]]);export{qe as default};
