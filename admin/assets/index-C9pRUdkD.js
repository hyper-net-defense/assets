import{p as h}from"./index-Dy79iS0B.js";/* empty css                   */import{u as Z}from"./usePagination-NdQ2qoRW.js";/* empty css                   *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 */import"./el-tooltip-l0sNRNKZ.js";/* empty css                *//* empty css                  */import{H as ee,I as le,J as ae,z as te,M as oe,y as ne,N as ie,O as ue,n as se,W as re,Q as de,R as pe,S as me,T as fe,U as _e,K as ve,L as ge,A as ce,V as be,E as y,_ as ye}from"./element-B-FiLDCl.js";import{a as U}from"./index-2rTwS3Je.js";/* empty css                       */import{v as Ve,r as d,aE as B,j as ke,x as j,y as V,O as l,G as Se,F as t,u,K as p,E,B as S,L as Ce,M as Ae,ab as Ee}from"./vue-Cwi6Gi-M.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vxe-5K_zVHhu.js";function Fe(m){return h({url:"/admin/signed_app/list",method:"post",data:m})}function Te(m){return h({url:"/admin/signed_app/add",method:"post",data:m})}function we(m){return h({url:"/admin/signed_app/update",method:"post",data:m})}function qe(m){return h({url:"/admin/signed_app/delete",method:"post",data:{id:m}})}const xe={class:"app-container"},De={class:"toolbar-wrapper"},Pe={class:"table-wrapper"},ze={class:"pager-wrapper"},Re=Ve({__name:"index",setup(m){const C=d(!1),g=d(!1),k=d(!1),q=B("signedAppFormRef"),x=B("searchFormRef"),_=d({build:"",os:""}),F=d([]),{paginationData:s,handleCurrentChange:L,handleSizeChange:O}=Z(),c=d(!1),T=d(""),o=d({id:"",build:"",os:"",obj_key:"",pv_key:"",plan:0,domain:"",is_active:!0}),M=d({build:[{required:!0,message:"The build is required.",trigger:"blur"}],os:[{required:!0,message:"The os is required.",trigger:"blur"}],obj_key:[{required:!0,message:"The object key is required.",trigger:"blur"}],pv_key:[{required:!0,message:"The pv key is required.",trigger:"blur"}],plan:[{required:!0,message:"The plan is required.",trigger:"blur"}],is_active:[{required:!0,message:"The active is required.",trigger:"blur"}]});function v(){C.value||(C.value=!0,Fe({build:_.value.build,os:_.value.os,curPage:s.currentPage,pageSize:s.pageSize}).then(n=>{n.success&&n.data&&n.pagination?(F.value=n.data.signed_app_list,s.total=n.pagination.total):(F.value=[],s.total=0)}).finally(()=>{C.value=!1}))}function D(n){n?(T.value="Edit Singed App",o.value={...n}):(T.value="Add Singed App",o.value={id:"",build:"",os:"",obj_key:"",pv_key:"",plan:0,domain:"",is_active:!0}),c.value=!0}function N(){var n;g.value||(g.value=!0,(n=q.value)==null||n.validate(e=>{if(!e){y.error("The form validation failed."),g.value=!1;return}o.value.id?we(o.value).then(i=>{i.success?(y.success("Succeed to update."),c.value=!1,v()):y.error(i.message||"Failed to update.")}).finally(()=>{g.value=!1}):Te(o.value).then(i=>{i.success?(y.success("Succeed to add."),c.value=!1,v()):y.error(i.message||"Failed to add.")}).finally(()=>{g.value=!1})}))}function I(n){ye.confirm("Are you sure to delete this app?","Confirm",{type:"warning"}).then(()=>{n.id&&(k.value||(k.value=!0,qe(n.id).then(e=>{e.success?v():y.error(e.message||"Failed to delete.")}).finally(()=>{k.value=!1})))}).catch(()=>{k.value=!1})}function K(){var n;(n=x.value)==null||n.resetFields(),v()}return ke([()=>s.currentPage,()=>s.pageSize],v,{immediate:!0}),(n,e)=>{const i=ae,r=le,f=te,P=ee,z=ie,R=se,b=me,w=fe,$=pe,G=_e,H=ge,J=ve,Q=ce,W=be,Y=ue;return V(),j("div",xe,[l(z,{shadow:"never",class:"search-wrapper"},{default:t(()=>[l(P,{inline:!0,ref_key:"searchFormRef",ref:x,model:_.value},{default:t(()=>[l(r,{label:"Build",prop:"build"},{default:t(()=>[l(i,{modelValue:_.value.build,"onUpdate:modelValue":e[0]||(e[0]=a=>_.value.build=a),placeholder:"Search build",clearable:""},null,8,["modelValue"])]),_:1}),l(r,{label:"OS",prop:"os"},{default:t(()=>[l(i,{modelValue:_.value.os,"onUpdate:modelValue":e[1]||(e[1]=a=>_.value.os=a),placeholder:"Search os",clearable:""},null,8,["modelValue"])]),_:1}),l(r,null,{default:t(()=>[l(f,{type:"primary",icon:u(oe),onClick:v},{default:t(()=>e[12]||(e[12]=[p(" Search ")])),_:1,__:[12]},8,["icon"]),l(f,{icon:u(ne),onClick:K},{default:t(()=>e[13]||(e[13]=[p(" Reset ")])),_:1,__:[13]},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1}),Se((V(),E(z,{shadow:"never"},{default:t(()=>[S("div",De,[e[14]||(e[14]=S("div",null,null,-1)),S("div",null,[l(R,{content:"Add new"},{default:t(()=>[l(f,{type:"primary",icon:u(re),circle:"",onClick:e[2]||(e[2]=a=>D())},null,8,["icon"])]),_:1}),l(R,{content:"Refresh current page"},{default:t(()=>[l(f,{type:"primary",icon:u(de),circle:"",onClick:v},null,8,["icon"])]),_:1})])]),S("div",Pe,[l($,{data:F.value,stripe:""},{default:t(()=>[l(b,{prop:"build",label:"Build"}),l(b,{prop:"os",label:"OS"}),l(b,{prop:"plan",label:"Plan"},{default:t(({row:a})=>[l(w,{type:"primary"},{default:t(()=>{var A;return[p(Ce((A=u(U).find(X=>X.id===a.plan))==null?void 0:A.text),1)]}),_:2},1024)]),_:1}),l(b,{prop:"domain",label:"Domain"}),l(b,{prop:"is_active",label:"Active"},{default:t(({row:a})=>[a.is_active?(V(),E(w,{key:0,type:"success"},{default:t(()=>e[15]||(e[15]=[p(" Yes ")])),_:1,__:[15]})):(V(),E(w,{key:1,type:"danger"},{default:t(()=>e[16]||(e[16]=[p(" No ")])),_:1,__:[16]}))]),_:1}),l(b,{label:"Action",width:"150"},{default:t(({row:a})=>[l(f,{type:"primary",plain:"",size:"small",onClick:A=>D(a)},{default:t(()=>e[17]||(e[17]=[p(" Edit ")])),_:2,__:[17]},1032,["onClick"]),l(f,{type:"danger",size:"small",onClick:A=>I(a)},{default:t(()=>e[18]||(e[18]=[p(" Delete ")])),_:2,__:[18]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),S("div",ze,[l(G,{backround:"",layout:u(s).layout,total:u(s).total,"page-size":u(s).pageSize,"current-page":u(s).currentPage,onCurrentChange:u(L),onSizeChange:u(O)},null,8,["layout","total","page-size","current-page","onCurrentChange","onSizeChange"])])]),_:1})),[[Y,C.value||k.value]]),l(W,{title:T.value,modelValue:c.value,"onUpdate:modelValue":e[11]||(e[11]=a=>c.value=a),width:"500px"},{footer:t(()=>[l(f,{onClick:e[10]||(e[10]=a=>c.value=!1)},{default:t(()=>e[19]||(e[19]=[p(" Cancel ")])),_:1,__:[19]}),l(f,{type:"primary",loading:g.value,onClick:N},{default:t(()=>e[20]||(e[20]=[p(" Save ")])),_:1,__:[20]},8,["loading"])]),default:t(()=>[l(P,{model:o.value,rules:M.value,ref_key:"signedAppFormRef",ref:q,"label-width":"80px","label-position":"left"},{default:t(()=>[l(r,{label:"Build",prop:"build"},{default:t(()=>[l(i,{modelValue:o.value.build,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.build=a)},null,8,["modelValue"])]),_:1}),l(r,{label:"OS",prop:"os"},{default:t(()=>[l(i,{modelValue:o.value.os,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.os=a)},null,8,["modelValue"])]),_:1}),l(r,{label:"Obj Key",prop:"obj_key"},{default:t(()=>[l(i,{modelValue:o.value.obj_key,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.obj_key=a)},null,8,["modelValue"])]),_:1}),l(r,{label:"Pv Key",prop:"pv_key"},{default:t(()=>[l(i,{modelValue:o.value.pv_key,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.pv_key=a)},null,8,["modelValue"])]),_:1}),l(r,{label:"Plan",prop:"plan"},{default:t(()=>[l(J,{modelValue:o.value.plan,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.plan=a),placeholder:"Select Plan",class:"w-full"},{default:t(()=>[(V(!0),j(Ae,null,Ee(u(U),a=>(V(),E(H,{key:a.id,label:a.text,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"Domain",prop:"domain"},{default:t(()=>[l(i,{modelValue:o.value.domain,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.domain=a)},null,8,["modelValue"])]),_:1}),l(r,{label:"Active",prop:"is_active"},{default:t(()=>[l(Q,{modelValue:o.value.is_active,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.is_active=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}}),el=he(Re,[["__scopeId","data-v-6c2ffda9"]]);export{el as default};
